version: '3.4'

services:
  tests:
    build:
      context: .
      target: ci
    volumes:
      - ${WORKSPACE}/reports:/app/reports
    environment:
      - DJANGO_SETTINGS_MODULE=zrc.conf.ci
      - SECRET_KEY=jenkins
      - DB_NAME=postgres
      - DB_USER=postgres
      - DB_PASSWORD=
      - DB_HOST=db
      - WORKSPACE=${WORKSPACE}
      - ZTC_JWT_SECRET=dummy
    depends_on:
      - db
